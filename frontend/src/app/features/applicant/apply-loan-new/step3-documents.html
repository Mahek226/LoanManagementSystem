<!-- Step 3: Upload Documents -->
<div class="step-content" *ngIf="currentStep === 3">
  <div class="step-header">
    <h3><i class="fas fa-file-upload me-2"></i>Upload Documents</h3>
    <p class="text-muted">Upload all required documents for verification</p>
  </div>

  <div class="documents-section">
    <div class="row g-4">
      <div class="col-lg-6" *ngFor="let docReq of requiredDocuments">
        <div class="document-card" [class.uploaded]="uploadedDocuments.some(d => d.documentType === docReq.documentType)">
          <div class="doc-header">
            <div class="d-flex align-items-center">
              <i class="fas {{ docReq.icon }} me-2"></i>
              <div>
                <h6 class="mb-0">{{ docReq.displayName }}</h6>
                <small class="text-muted">{{ docReq.description }}</small>
              </div>
            </div>
            <span class="badge" [class.bg-success]="uploadedDocuments.some(d => d.documentType === docReq.documentType)"
                  [class.bg-warning]="!uploadedDocuments.some(d => d.documentType === docReq.documentType) && docReq.required">
              {{ uploadedDocuments.some(d => d.documentType === docReq.documentType) ? 'Uploaded' : (docReq.required ? 'Required' : 'Optional') }}
            </span>
          </div>

          <div class="doc-body">
            <!-- Upload Area -->
            <div class="upload-area" 
                 [class.drag-over]="dragOver"
                 (dragover)="onDragOver($event)"
                 (dragleave)="onDragLeave($event)"
                 (drop)="onDrop($event, docReq.documentType)"
                 *ngIf="!uploadedDocuments.some(d => d.documentType === docReq.documentType)">
              <i class="fas fa-cloud-upload-alt"></i>
              <p>Drag & drop or click to upload</p>
              <small>{{ docReq.acceptedFormats.join(', ') }}</small>
              <small>Max size: {{ (docReq.maxSize / (1024 * 1024)).toFixed(0) }}MB</small>
              <input type="file" 
                     [accept]="docReq.acceptedFormats.join(',')"
                     (change)="onFileSelected($event, docReq.documentType)"
                     style="display: none;"
                     #fileInput>
              <button type="button" class="btn btn-sm btn-primary mt-2" (click)="fileInput.click()">
                <i class="fas fa-upload me-1"></i>Choose File
              </button>
            </div>

            <!-- Uploaded File -->
            <div class="uploaded-file" *ngIf="uploadedDocuments.some(d => d.documentType === docReq.documentType)">
              <ng-container *ngFor="let doc of uploadedDocuments">
                <div class="file-item" *ngIf="doc.documentType === docReq.documentType">
                  <div class="d-flex align-items-center justify-content-between">
                    <div class="d-flex align-items-center">
                      <i class="fas fa-file-pdf text-danger me-2"></i>
                      <div>
                        <p class="mb-0">{{ doc.fileName }}</p>
                        <small class="text-muted">{{ (doc.fileSize / 1024).toFixed(0) }} KB</small>
                      </div>
                    </div>
                    <button type="button" class="btn btn-sm btn-outline-danger" (click)="removeDocument(doc.fileName)">
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                </div>
              </ng-container>
            </div>

            <!-- Upload Progress -->
            <div class="upload-progress" *ngIf="uploadProgress[docReq.documentType]">
              <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-animated" 
                     [style.width.%]="uploadProgress[docReq.documentType].progress">
                  {{ uploadProgress[docReq.documentType].progress }}%
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Upload Tips -->
    <div class="alert alert-info mt-4">
      <h6><i class="fas fa-lightbulb me-2"></i>Upload Tips:</h6>
      <ul class="mb-0">
        <li>Ensure documents are clear and readable</li>
        <li>All text should be visible without glare or shadows</li>
        <li>For photos, use good lighting and avoid blurry images</li>
        <li>Accepted formats: PDF, JPG, PNG</li>
        <li>You can use your mobile camera to capture documents</li>
      </ul>
    </div>
  </div>
</div>
