<div class="min-h-screen bg-gray-50">
  <!-- Header Section -->
  <div class="bg-gradient-to-r from-blue-800 to-blue-900 shadow-lg">
    <div class="container mx-auto px-4 py-6">
      <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
          <img src="assets/images/logo.jpeg" alt="FraudShield Logo" 
               class="w-12 h-12 rounded-lg object-cover shadow-md me-3" 
               (error)="onImageError()"
               [style.display]="showFallbackLogo ? 'none' : 'block'">
          
          <div class="w-12 h-12 bg-white bg-opacity-20 rounded-lg d-flex align-items-center justify-content-center me-3" 
               *ngIf="showFallbackLogo">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white">
              <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
              <path d="M2 17l10 5 10-5"></path>
              <path d="M2 12l10 5 10-5"></path>
            </svg>
          </div>

          <div class="text-white">
            <h1 class="h4 fw-bold mb-0">FraudShield</h1>
            <p class="small mb-0 opacity-75">Secure Loan Management</p>
          </div>
        </div>

        <!-- Progress Indicator -->
        <div class="d-flex align-items-center gap-3 text-white d-none d-md-flex">
          <div class="d-flex align-items-center gap-2">
            <div class="w-8 h-8 bg-white bg-opacity-30 rounded-full d-flex align-items-center justify-content-center">
              <span class="small fw-bold">1</span>
            </div>
            <span class="small">Register</span>
          </div>
          <div class="w-10 h-0.5 bg-white bg-opacity-30"></div>
          <div class="d-flex align-items-center gap-2">
            <div class="w-8 h-8 bg-white rounded-full d-flex align-items-center justify-content-center text-blue-800">
              <span class="small fw-bold">2</span>
            </div>
            <span class="small fw-bold">Verify Email</span>
          </div>
          <div class="w-10 h-0.5 bg-white bg-opacity-30"></div>
          <div class="d-flex align-items-center gap-2">
            <div class="w-8 h-8 bg-white bg-opacity-30 rounded-full d-flex align-items-center justify-content-center">
              <span class="small fw-bold">3</span>
            </div>
            <span class="small">Complete</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="container mx-auto px-4 py-8">
    <div class="row justify-content-center">
      <div class="col-lg-6 col-xl-5">
        <div class="card-custom mb-4">
          <div class="card-body p-4 p-md-5">
            <div class="text-center mb-4">
              <div class="w-16 h-16 bg-blue-100 rounded-full d-flex align-items-center justify-content-center mx-auto mb-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600">
                  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                  <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
              </div>
              <h2 class="h3 fw-bold text-gray-800 mb-2">Verify Your Email</h2>
              <p class="text-muted mb-2">
                We've sent a 6-digit verification code to <strong class="text-blue-600">{{ email }}</strong>
              </p>
              
              <!-- OTP Timer Display -->
              <div class="d-flex justify-content-center align-items-center gap-3 mb-3">
                <div class="badge bg-warning text-dark px-3 py-2" *ngIf="otpTimeRemaining > 0">
                  <i class="fas fa-clock me-1"></i>
                  OTP expires in: <strong>{{ otpExpiryDisplay }}</strong>
                </div>
                <div class="badge bg-danger px-3 py-2" *ngIf="otpTimeRemaining <= 0">
                  <i class="fas fa-exclamation-triangle me-1"></i>
                  OTP Expired
                </div>
              </div>
            </div>

            <!-- Success Message -->
            <div *ngIf="successMessage" class="alert-success-custom mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="20,6 9,17 4,12"></polyline>
              </svg>
              {{ successMessage }}
            </div>

            <!-- Error Message -->
            <div *ngIf="errorMessage" class="alert-error-custom mb-4">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
              </svg>
              {{ errorMessage }}
            </div>

            <!-- Verification Form -->
            <form [formGroup]="verificationForm" (ngSubmit)="onSubmit()" class="needs-validation" novalidate>
              
              <!-- OTP Input -->
              <div class="mb-4">
                <label for="otp" class="form-label fw-semibold text-center d-block">Verification Code</label>
                <input
                  type="text"
                  id="otp"
                  formControlName="otp"
                  class="form-input-custom text-center fs-4 fw-bold letter-spacing-wider"
                  [class.form-input-error]="submitted && f['otp'].errors"
                  placeholder="000000"
                  maxlength="6"
                  style="font-family: 'Courier New', monospace; letter-spacing: 0.5rem;"
                />
                <div *ngIf="submitted && f['otp'].errors" class="text-danger small mt-2 text-center">
                  <span *ngIf="f['otp'].errors['required']">Verification code is required</span>
                  <span *ngIf="f['otp'].errors['pattern']">Please enter a valid 6-digit code</span>
                </div>
              </div>

              <!-- Verify Button -->
              <div class="d-grid gap-2 mb-4">
                <button 
                  type="submit" 
                  class="btn-primary-custom"
                  [disabled]="loading"
                >
                  <span *ngIf="!loading">Verify Email</span>
                  <span *ngIf="loading" class="d-flex align-items-center justify-content-center">
                    <div class="spinner-border spinner-border-sm me-2" role="status">
                      <span class="visually-hidden">Loading...</span>
                    </div>
                    Verifying...
                  </span>
                </button>
              </div>

              <!-- Resend Section -->
              <div class="card border-0 bg-light">
                <div class="card-body text-center py-3">
                  <p class="text-muted small mb-2">Didn't receive the code?</p>
                  
                  <!-- Resend Timer Display -->
                  <div class="mb-2" *ngIf="!canResend && resendTimeRemaining > 0">
                    <small class="text-info">
                      <i class="fas fa-info-circle me-1"></i>
                      Resend available in: <strong>{{ resendTimerDisplay }}</strong>
                    </small>
                  </div>
                  
                  <button 
                    type="button" 
                    class="btn-secondary-custom btn-sm"
                    [disabled]="!canResend || resendLoading || otpTimeRemaining <= 0"
                    (click)="resendOTP()"
                  >
                    <span *ngIf="!resendLoading && canResend && otpTimeRemaining > 0">
                      <i class="fas fa-redo me-1"></i>
                      Resend Code
                    </span>
                    <span *ngIf="resendLoading" class="d-flex align-items-center justify-content-center">
                      <div class="spinner-border spinner-border-sm me-2" role="status">
                        <span class="visually-hidden">Loading...</span>
                      </div>
                      Sending New Code...
                    </span>
                    <span *ngIf="!canResend && resendTimeRemaining > 0">
                      <i class="fas fa-clock me-1"></i>
                      Wait {{ resendTimerDisplay }}
                    </span>
                    <span *ngIf="otpTimeRemaining <= 0">
                      <i class="fas fa-exclamation-triangle me-1"></i>
                      Request New Code
                    </span>
                  </button>
                  
                  <div class="mt-2" *ngIf="otpTimeRemaining <= 0">
                    <small class="text-danger">
                      <i class="fas fa-exclamation-triangle me-1"></i>
                      Current OTP has expired. Please request a new one.
                    </small>
                  </div>
                </div>
              </div>

              <!-- Navigation Links -->
              <div class="d-flex justify-content-between mt-4 pt-3 border-top">
                <button type="button" class="btn btn-link text-decoration-none p-0" (click)="navigateToRegister()">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1">
                    <polyline points="15,18 9,12 15,6"></polyline>
                  </svg>
                  Back to Registration
                </button>
                <button type="button" class="btn btn-link text-decoration-none p-0" (click)="navigateToLogin()">
                  Already verified? Sign In
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ms-1">
                    <polyline points="9,18 15,12 9,6"></polyline>
                  </svg>
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-4 mt-auto">
    <div class="container mx-auto px-4">
      <div class="row align-items-center">
        <div class="col-md-6">
          <p class="mb-0 small">&copy; 2025 FraudShield Loan Management System. All rights reserved.</p>
        </div>
        <div class="col-md-6 text-md-end">
          <div class="d-flex justify-content-md-end gap-3">
            <a href="#" class="text-white-50 text-decoration-none small hover:text-white">Privacy Policy</a>
            <a href="#" class="text-white-50 text-decoration-none small hover:text-white">Terms of Service</a>
            <a href="#" class="text-white-50 text-decoration-none small hover:text-white">Support</a>
          </div>
        </div>
      </div>
    </div>
  </footer>
</div>
